extends nav

block title
  title #{metadata.title}
  
block scripts
  script(src="/js/library.js")
  script
    $(function() {
      window.Libraries.#{metadata.name} = window.Libraries.DocumentModelFactory({});
      window.Libraries.#{metadata.name}Collection = window.Libraries.DocumentCollectionFactory(window.Libraries.#{metadata.name}, '/api/libraries/#{metadata.name}');
      var app = new window.Libraries.LibraryView({
        modelType: window.Libraries.#{metadata.name},
        collectionType: window.Libraries.#{metadata.name}Collection
      });
    })

block content
  .row-fluid
    .btn-toolbar.span9(style="margin-top: 0; margin-bottom: 0;")
      .btn-group
        btn.btn#refresh
          i.icon-refresh
          | Refresh
        btn.btn#addDocument
          i.icon-plus
          | New
        btn.btn.disabled#editDocument(disabled)
          i.icon-pencil
          | Edit
        btn.btn.disabled#delete(disabled)
          i.icon-trash
          | Delete

      .btn-group
        a.btn(href="/admin/docs/#{metadata.name}")
          i.icon-wrench
          | Configure

  table.table.table-striped.table-condensed
    thead
      tr
        th
          input#selectAll(type="checkbox")
        each field, i in metadata.fields
          th
            | #{field.heading}
    tbody

  script#documentTemplate(type="template")
    td
      input.selector(type="checkbox")
    each field, i in metadata.fields
      case field.type
        when 'String': td {{ #{field.name} }}
        when 'Url': td: a(href="{{ #{field.name} }}"): {{ #{field.name} }}
        when 'Name': td: a.namefield(href="/docs/#{metadata.name}/{{ #{field.name} }}"): {{ #{field.name} }}

  hr

block modal
  // - New Document Modal Dialog
  #newDocumentModal.modal.hide.fade
    .modal-header
      button.close(data-dismiss="modal") x
      h3 Add new document
    .modal-body
      form#newDocumentForm.form-horizontal.well
        fieldset
          .control-group
            label.control-label File
            .controls
              input.input-xlarge(type="file")
          each field, i in metadata.fields
            .control-group
              label.control-label(for="#{field.name}") #{field.heading}
              .controls
                input.input-xlarge(name="#{field.name}", type="#{field.formType}", placeholder="#{field.placeholder}")
          input(type="submit", style="visibility:hidden;")
    .modal-footer
      a#addDocumentCancel.btn.btn-inverse(href="#") Cancel
      a#addDocumentSubmit.btn.btn-primary.submit(href="#") Add Item

  // - Edit Document Modal Dialog
  #editDocumentModal.modal.hide.fade
    .modal-header
      button.close(data-dismiss="modal") x
      h3 Edit document

    .modal-body
      form#editDocumentForm.form-horizontal.well
        fieldset
          each field, i in metadata.fields
            .control-group
              label.control-label #{field.heading}
              .controls
                input.input-xlarge(name="#{field.name}", placeholder="#{field.placeholder}", disabled=(field.type == 'Name'))
          input(type="submit", style="visibility:hidden;")

    .modal-footer
      a#editDocumentCancel.btn.btn-inverse(href="#") Cancel
      a#editDocumentSubmit.btn.btn-primary.submit(href="#") Update
